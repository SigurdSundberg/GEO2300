If you are copying any of this, ignore everything regarding tridiag solvers. Only the function matrix solutions is of any interest.
